==========================================
SLURM Array Task ID: 2
Processing dataset: mnli
==========================================

Configuration:
  Seeds: 42 43 44
  Budgets: 200 500 1000 5000
  Epochs: 20
  Checkpoint dir: checkpoints/mnli
  Results dir: results/mnli

================================================
SEED 42 - Training Victim Models
================================================
✓ Victim (no DP) already exists: checkpoints/mnli/victim_mnli_P20_seed42.pt
[mnli] Training victim (DP) with seed 42...
[Task] mnli (GLUE/mnli) | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[DP] eps=8.0 C=0.1
[Save] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt
[Log]  checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.json
[DP] batch_size=256 steps=1533 sample_rate=0.000652 sigma=0.4150
Epoch 0 | val acc=0.4642 | conf=0.644 | ||P||=1.02 | pos_rate=nan
Epoch 1 | val acc=0.7759 | conf=0.941 | ||P||=35.43 | pos_rate=nan
  ✓ Saved best DP prompt (acc=0.7759) to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt
Done. Best val acc=0.7759 | saved=checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt
✓ Victim (DP) saved to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt

================================================
SEED 42 | BUDGET 200 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=200, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed42_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=200, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed42_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=200, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed42_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=200, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 200 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7454 | f1=nan | conf=0.638 | pos_rate=nan
  → Agreement=0.8238 | KL(v||s)=0.203821 | cos_sim=0.073

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7331 | f1=nan | conf=0.681 | pos_rate=nan
  → Agreement=0.8227 | KL(v||s)=0.396429 | cos_sim=0.035
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7454 | f1=nan | conf=0.679 | pos_rate=nan
  → Agreement=0.8208 | KL(v||s)=0.199224 | cos_sim=0.071

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7411 | f1=nan | conf=0.688 | pos_rate=nan
  → Agreement=0.8341 | KL(v||s)=0.374565 | cos_sim=0.042
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 42

================================================
SEED 42 | BUDGET 500 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=500, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed42_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=500, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed42_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=500, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed42_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=500, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 500 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7728 | f1=nan | conf=0.685 | pos_rate=nan
  → Agreement=0.8794 | KL(v||s)=0.148493 | cos_sim=0.063

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7587 | f1=nan | conf=0.721 | pos_rate=nan
  → Agreement=0.8656 | KL(v||s)=0.319772 | cos_sim=0.029
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7670 | f1=nan | conf=0.719 | pos_rate=nan
  → Agreement=0.8586 | KL(v||s)=0.158224 | cos_sim=0.050

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7524 | f1=nan | conf=0.726 | pos_rate=nan
  → Agreement=0.8566 | KL(v||s)=0.330115 | cos_sim=0.033
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 42

================================================
SEED 42 | BUDGET 1000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=1000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed42_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=1000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed42_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=1000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed42_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=1000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 1000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7755 | f1=nan | conf=0.714 | pos_rate=nan
  → Agreement=0.8958 | KL(v||s)=0.106835 | cos_sim=0.073

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7498 | f1=nan | conf=0.770 | pos_rate=nan
  → Agreement=0.8675 | KL(v||s)=0.287093 | cos_sim=0.038
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7582 | f1=nan | conf=0.760 | pos_rate=nan
  → Agreement=0.8526 | KL(v||s)=0.188931 | cos_sim=0.055

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7425 | f1=nan | conf=0.778 | pos_rate=nan
  → Agreement=0.8450 | KL(v||s)=0.329847 | cos_sim=0.036
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 42

================================================
SEED 42 | BUDGET 5000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=5000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed42_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=5000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed42_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=5000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed42_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=5000, seed=42...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 5000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7874 | f1=nan | conf=0.761 | pos_rate=nan
  → Agreement=0.9310 | KL(v||s)=0.043850 | cos_sim=0.085

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7686 | f1=nan | conf=0.913 | pos_rate=nan
  → Agreement=0.9072 | KL(v||s)=0.135364 | cos_sim=0.008
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=42 | budget=5000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7946 | f1=nan | conf=0.809 | pos_rate=nan
Stolen:  acc=0.7790 | f1=nan | conf=0.919 | pos_rate=nan
  → Agreement=0.8999 | KL(v||s)=0.312239 | cos_sim=0.062

--- WITH DP ---
Victim:  acc=0.7759 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7574 | f1=nan | conf=0.924 | pos_rate=nan
  → Agreement=0.8789 | KL(v||s)=0.256978 | cos_sim=0.005
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 5000, seed 42

================================================
Completed all budgets for SEED 42
================================================

================================================
SEED 43 - Training Victim Models
================================================
[mnli] Training victim (no DP) with seed 43...
[Task] mnli (GLUE/mnli) | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[Save] checkpoints/mnli/victim_mnli_P20_seed43.pt
[Log]  checkpoints/mnli/victim_mnli_P20_seed43.json
Epoch 0 | val acc=0.3927 | conf=0.700 | ||P||=1.00 | pos_rate=nan
Epoch 1 | train_loss=0.4904 | val acc=0.7926 | conf=0.803 | ||P||=21.82 | pos_rate=nan
  ✓ Saved best prompt (acc=0.7926) to checkpoints/mnli/victim_mnli_P20_seed43.pt
Done. Best val acc=0.7926 | saved=checkpoints/mnli/victim_mnli_P20_seed43.pt
✓ Victim (no DP) saved to checkpoints/mnli/victim_mnli_P20_seed43.pt
[mnli] Training victim (DP) with seed 43...
[Task] mnli (GLUE/mnli) | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[DP] eps=8.0 C=0.1
[Save] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt
[Log]  checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.json
[DP] batch_size=256 steps=1533 sample_rate=0.000652 sigma=0.4150
Epoch 0 | val acc=0.3927 | conf=0.700 | ||P||=1.00 | pos_rate=nan
Epoch 1 | val acc=0.7555 | conf=0.941 | ||P||=34.13 | pos_rate=nan
  ✓ Saved best DP prompt (acc=0.7555) to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt
Done. Best val acc=0.7555 | saved=checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt
✓ Victim (DP) saved to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt

================================================
SEED 43 | BUDGET 200 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=200, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=200, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=200, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed43_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=200, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 200 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7393 | f1=nan | conf=0.635 | pos_rate=nan
  → Agreement=0.8117 | KL(v||s)=0.212710 | cos_sim=0.077

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7404 | f1=nan | conf=0.643 | pos_rate=nan
  → Agreement=0.7813 | KL(v||s)=0.461904 | cos_sim=0.068
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7544 | f1=nan | conf=0.666 | pos_rate=nan
  → Agreement=0.8250 | KL(v||s)=0.190807 | cos_sim=0.069

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7463 | f1=nan | conf=0.652 | pos_rate=nan
  → Agreement=0.7948 | KL(v||s)=0.447416 | cos_sim=0.063
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 43

================================================
SEED 43 | BUDGET 500 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=500, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=500, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=500, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed43_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=500, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 500 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7576 | f1=nan | conf=0.645 | pos_rate=nan
  → Agreement=0.8627 | KL(v||s)=0.175427 | cos_sim=0.069

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7610 | f1=nan | conf=0.698 | pos_rate=nan
  → Agreement=0.8663 | KL(v||s)=0.356010 | cos_sim=0.072
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7735 | f1=nan | conf=0.701 | pos_rate=nan
  → Agreement=0.8756 | KL(v||s)=0.146250 | cos_sim=0.065

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7593 | f1=nan | conf=0.709 | pos_rate=nan
  → Agreement=0.8570 | KL(v||s)=0.351079 | cos_sim=0.070
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 43

================================================
SEED 43 | BUDGET 1000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=1000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=1000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=1000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed43_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=1000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 1000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7803 | f1=nan | conf=0.708 | pos_rate=nan
  → Agreement=0.9230 | KL(v||s)=0.089168 | cos_sim=0.097

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7621 | f1=nan | conf=0.763 | pos_rate=nan
  → Agreement=0.8609 | KL(v||s)=0.315200 | cos_sim=0.077
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7692 | f1=nan | conf=0.760 | pos_rate=nan
  → Agreement=0.8746 | KL(v||s)=0.162439 | cos_sim=0.051

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7561 | f1=nan | conf=0.766 | pos_rate=nan
  → Agreement=0.8440 | KL(v||s)=0.348571 | cos_sim=0.060
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 43

================================================
SEED 43 | BUDGET 5000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=5000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=5000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=5000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed43_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=5000, seed=43...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 5000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7855 | f1=nan | conf=0.777 | pos_rate=nan
  → Agreement=0.9474 | KL(v||s)=0.024505 | cos_sim=0.056

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7611 | f1=nan | conf=0.896 | pos_rate=nan
  → Agreement=0.8951 | KL(v||s)=0.164619 | cos_sim=0.055
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=43 | budget=5000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7926 | f1=nan | conf=0.803 | pos_rate=nan
Stolen:  acc=0.7787 | f1=nan | conf=0.899 | pos_rate=nan
  → Agreement=0.8976 | KL(v||s)=0.289250 | cos_sim=0.066

--- WITH DP ---
Victim:  acc=0.7555 | f1=nan | conf=0.941 | pos_rate=nan
Stolen:  acc=0.7543 | f1=nan | conf=0.913 | pos_rate=nan
  → Agreement=0.8911 | KL(v||s)=0.192821 | cos_sim=0.049
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 5000, seed 43

================================================
Completed all budgets for SEED 43
================================================

================================================
SEED 44 - Training Victim Models
================================================
[mnli] Training victim (no DP) with seed 44...
[Task] mnli (GLUE/mnli) | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[Save] checkpoints/mnli/victim_mnli_P20_seed44.pt
[Log]  checkpoints/mnli/victim_mnli_P20_seed44.json
Epoch 0 | val acc=0.3614 | conf=0.836 | ||P||=1.02 | pos_rate=nan
Epoch 1 | train_loss=0.5083 | val acc=0.7809 | conf=0.796 | ||P||=24.84 | pos_rate=nan
  ✓ Saved best prompt (acc=0.7809) to checkpoints/mnli/victim_mnli_P20_seed44.pt
Done. Best val acc=0.7809 | saved=checkpoints/mnli/victim_mnli_P20_seed44.pt
✓ Victim (no DP) saved to checkpoints/mnli/victim_mnli_P20_seed44.pt
[mnli] Training victim (DP) with seed 44...
[Task] mnli (GLUE/mnli) | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[DP] eps=8.0 C=0.1
[Save] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt
[Log]  checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.json
[DP] batch_size=256 steps=1533 sample_rate=0.000652 sigma=0.4150
Epoch 0 | val acc=0.3614 | conf=0.836 | ||P||=1.02 | pos_rate=nan
Epoch 1 | val acc=0.7828 | conf=0.947 | ||P||=35.13 | pos_rate=nan
  ✓ Saved best DP prompt (acc=0.7828) to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt
Done. Best val acc=0.7828 | saved=checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt
✓ Victim (DP) saved to checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt

================================================
SEED 44 | BUDGET 200 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=200, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=200, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget200_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=200, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed44_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=200, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget200_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 200 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7684 | f1=nan | conf=0.665 | pos_rate=nan
  → Agreement=0.8408 | KL(v||s)=0.142528 | cos_sim=0.053

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7504 | f1=nan | conf=0.694 | pos_rate=nan
  → Agreement=0.8338 | KL(v||s)=0.370617 | cos_sim=0.034
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7559 | f1=nan | conf=0.693 | pos_rate=nan
  → Agreement=0.8095 | KL(v||s)=0.158193 | cos_sim=0.045

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7527 | f1=nan | conf=0.705 | pos_rate=nan
  → Agreement=0.8489 | KL(v||s)=0.352541 | cos_sim=0.039
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 44

================================================
SEED 44 | BUDGET 500 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=500, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=500, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget500_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=500, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed44_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=500, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget500_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 500 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7733 | f1=nan | conf=0.676 | pos_rate=nan
  → Agreement=0.8763 | KL(v||s)=0.119118 | cos_sim=0.081

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7670 | f1=nan | conf=0.728 | pos_rate=nan
  → Agreement=0.8878 | KL(v||s)=0.292965 | cos_sim=0.038
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7657 | f1=nan | conf=0.714 | pos_rate=nan
  → Agreement=0.8465 | KL(v||s)=0.151416 | cos_sim=0.072

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7523 | f1=nan | conf=0.725 | pos_rate=nan
  → Agreement=0.8557 | KL(v||s)=0.332421 | cos_sim=0.034
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 44

================================================
SEED 44 | BUDGET 1000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=1000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=1000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget1000_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=1000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed44_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=1000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget1000_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 1000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7739 | f1=nan | conf=0.720 | pos_rate=nan
  → Agreement=0.8992 | KL(v||s)=0.070916 | cos_sim=0.082

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7683 | f1=nan | conf=0.772 | pos_rate=nan
  → Agreement=0.9026 | KL(v||s)=0.240015 | cos_sim=0.039
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_probs.csv
  - results/mnli/mnli/results_dp_probs.csv

[mnli] Evaluating hard oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: MNLI
================================================================================

--- NO DP ---
Victim:  acc=0.7809 | f1=nan | conf=0.796 | pos_rate=nan
Stolen:  acc=0.7469 | f1=nan | conf=0.805 | pos_rate=nan
  → Agreement=0.8710 | KL(v||s)=0.137520 | cos_sim=0.048

--- WITH DP ---
Victim:  acc=0.7828 | f1=nan | conf=0.947 | pos_rate=nan
Stolen:  acc=0.7589 | f1=nan | conf=0.767 | pos_rate=nan
  → Agreement=0.8790 | KL(v||s)=0.280891 | cos_sim=0.043
================================================================================

✓ Results saved to results/mnli/mnli/
  - results/mnli/mnli/results_nodp_hard.csv
  - results/mnli/mnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 44

================================================
SEED 44 | BUDGET 5000 - Stealing
================================================
[mnli] Stealing (soft, no DP) | budget=5000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[mnli] Stealing (hard, no DP) | budget=5000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_mnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_nodp_budget5000_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[mnli] Stealing (soft, DP) | budget=5000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed44_soft.pt
✓ Stolen (soft, DP) saved
[mnli] Stealing (hard, DP) | budget=5000, seed=44...
[Task] mnli | labels=['entailment', 'neutral', 'contradiction'] | verbalizers=['entailment', 'neutral', 'contradiction']
[Victim] checkpoints/mnli/victim_dp_mnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting snli as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/mnli/stolen_mnli_dp_eps8.0_budget5000_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 5000 - Evaluation
================================================
[mnli] Evaluating soft oracle results...

================================================================================
EVALUATING: MNLI | seed=44 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...
