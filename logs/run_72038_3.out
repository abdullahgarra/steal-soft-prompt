==========================================
SLURM Array Task ID: 3
Processing dataset: qnli
==========================================

Configuration:
  Seeds: 42 43 44
  Budgets: 200 500 1000 5000
  Epochs: 20
  Checkpoint dir: checkpoints/qnli
  Results dir: results/qnli

================================================
SEED 42 - Training Victim Models
================================================
✓ Victim (no DP) already exists: checkpoints/qnli/victim_qnli_P20_seed42.pt
✓ Victim (DP) already exists: checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed42.pt

================================================
SEED 42 | BUDGET 200 - Stealing
================================================
✓ Stolen (soft, no DP) already exists
✓ Stolen (hard, no DP) already exists
✓ Stolen (soft, DP) already exists
✓ Stolen (hard, DP) already exists

================================================
SEED 42 | BUDGET 200 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5054 | f1=0.6712 | conf=0.589 | pos_rate=0.999
  → Agreement=0.5098 | KL(v||s)=0.439467 | cos_sim=0.077

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.8486 | f1=0.8441 | conf=0.813 | pos_rate=0.466
  → Agreement=0.9024 | KL(v||s)=0.226384 | cos_sim=0.021
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5164 | f1=0.6689 | conf=0.659 | pos_rate=0.955
  → Agreement=0.5204 | KL(v||s)=0.482011 | cos_sim=0.064

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.8484 | f1=0.8468 | conf=0.738 | pos_rate=0.484
  → Agreement=0.8938 | KL(v||s)=0.303784 | cos_sim=0.012
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 42

================================================
SEED 42 | BUDGET 500 - Stealing
================================================
✓ Stolen (soft, no DP) already exists
✓ Stolen (hard, no DP) already exists
✓ Stolen (soft, DP) already exists
✓ Stolen (hard, DP) already exists

================================================
SEED 42 | BUDGET 500 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5056 | f1=0.6709 | conf=0.625 | pos_rate=0.997
  → Agreement=0.5107 | KL(v||s)=0.454053 | cos_sim=0.060

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.5799 | f1=0.6966 | conf=0.684 | pos_rate=0.879
  → Agreement=0.5913 | KL(v||s)=0.612852 | cos_sim=0.009
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5102 | f1=0.6695 | conf=0.611 | pos_rate=0.977
  → Agreement=0.5149 | KL(v||s)=0.450945 | cos_sim=0.079

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.4944 | f1=0.0079 | conf=0.578 | pos_rate=0.004
  → Agreement=0.4951 | KL(v||s)=0.647047 | cos_sim=0.021
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 42

================================================
SEED 42 | BUDGET 1000 - Stealing
================================================
✓ Stolen (soft, no DP) already exists
✓ Stolen (hard, no DP) already exists
[qnli] Stealing (soft, DP) | budget=1000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed42_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=1000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 1000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5059 | f1=0.6715 | conf=0.598 | pos_rate=0.999
  → Agreement=0.5103 | KL(v||s)=0.444291 | cos_sim=0.077

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.5431 | f1=0.2151 | conf=0.604 | pos_rate=0.077
  → Agreement=0.5482 | KL(v||s)=0.601129 | cos_sim=0.009
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.8506 | f1=0.8590 | conf=0.863 | pos_rate=0.554
  → Agreement=0.8916 | KL(v||s)=0.128980 | cos_sim=0.049

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.6648 | f1=0.7103 | conf=0.672 | pos_rate=0.652
  → Agreement=0.6897 | KL(v||s)=0.527172 | cos_sim=0.008
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 42

================================================
SEED 42 | BUDGET 5000 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=5000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed42_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=5000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed42_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=5000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed42_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=5000, seed=42...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed42.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed42_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 42 | BUDGET 5000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.5698 | f1=0.6910 | conf=0.615 | pos_rate=0.887
  → Agreement=0.5753 | KL(v||s)=0.416946 | cos_sim=0.013

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.5362 | f1=0.2331 | conf=0.588 | pos_rate=0.099
  → Agreement=0.5446 | KL(v||s)=0.618214 | cos_sim=-0.012
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=42 | budget=5000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.9008 | f1=0.9023 | conf=0.901 | pos_rate=0.510
Stolen:  acc=0.6101 | f1=0.7174 | conf=0.811 | pos_rate=0.874
  → Agreement=0.6211 | KL(v||s)=0.492073 | cos_sim=0.029

--- WITH DP ---
Victim:  acc=0.8726 | f1=0.8740 | conf=0.977 | pos_rate=0.506
Stolen:  acc=0.8072 | f1=0.7985 | conf=0.796 | pos_rate=0.451
  → Agreement=0.8508 | KL(v||s)=0.298724 | cos_sim=0.001
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 5000, seed 42

================================================
Completed all budgets for SEED 42
================================================

================================================
SEED 43 - Training Victim Models
================================================
[qnli] Training victim (no DP) with seed 43...
[Task] qnli (GLUE/qnli) | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[Save] checkpoints/qnli/victim_qnli_P20_seed43.pt
[Log]  checkpoints/qnli/victim_qnli_P20_seed43.json
Epoch 0 | val acc=0.4946 | conf=0.980 | ||P||=1.00 | pos_rate=0.000
Epoch 1 | train_loss=0.3047 | val acc=0.8969 | conf=0.895 | ||P||=11.59 | pos_rate=0.535
  ✓ Saved best prompt (acc=0.8969) to checkpoints/qnli/victim_qnli_P20_seed43.pt
Epoch 2 | train_loss=0.2527 | val acc=0.8968 | conf=0.899 | ||P||=14.71 | pos_rate=0.495
Epoch 3 | train_loss=0.2466 | val acc=0.8969 | conf=0.894 | ||P||=17.39 | pos_rate=0.533
Done. Best val acc=0.8969 | saved=checkpoints/qnli/victim_qnli_P20_seed43.pt
✓ Victim (no DP) saved to checkpoints/qnli/victim_qnli_P20_seed43.pt
[qnli] Training victim (DP) with seed 43...
[Task] qnli (GLUE/qnli) | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[DP] eps=8.0 C=0.1
[Save] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt
[Log]  checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.json
[DP] batch_size=256 steps=1227 sample_rate=0.002444 sigma=0.4727
Epoch 0 | val acc=0.4946 | conf=0.980 | ||P||=1.00 | pos_rate=0.000
Epoch 1 | val acc=0.8598 | conf=0.970 | ||P||=19.52 | pos_rate=0.498
  ✓ Saved best DP prompt (acc=0.8598) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt
Epoch 2 | val acc=0.8684 | conf=0.973 | ||P||=26.84 | pos_rate=0.517
  ✓ Saved best DP prompt (acc=0.8684) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt
Epoch 3 | val acc=0.8686 | conf=0.977 | ||P||=32.20 | pos_rate=0.539
  ✓ Saved best DP prompt (acc=0.8686) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt
Done. Best val acc=0.8686 | saved=checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt
✓ Victim (DP) saved to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt

================================================
SEED 43 | BUDGET 200 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=200, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget200_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=200, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget200_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=200, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget200_seed43_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=200, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget200_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 200 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.5054 | f1=0.6714 | conf=0.600 | pos_rate=1.000
  → Agreement=0.5352 | KL(v||s)=0.418354 | cos_sim=0.020

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5054 | f1=0.6713 | conf=0.715 | pos_rate=0.999
  → Agreement=0.5391 | KL(v||s)=0.697257 | cos_sim=0.002
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.7611 | f1=0.7739 | conf=0.670 | pos_rate=0.551
  → Agreement=0.7913 | KL(v||s)=0.254867 | cos_sim=0.030

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5446 | f1=0.6856 | conf=0.625 | pos_rate=0.943
  → Agreement=0.5801 | KL(v||s)=0.598750 | cos_sim=-0.001
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 43

================================================
SEED 43 | BUDGET 500 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=500, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget500_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=500, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget500_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=500, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget500_seed43_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=500, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget500_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 500 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.5345 | f1=0.6717 | conf=0.566 | pos_rate=0.913
  → Agreement=0.5621 | KL(v||s)=0.397679 | cos_sim=0.051

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5050 | f1=0.6711 | conf=0.729 | pos_rate=1.000
  → Agreement=0.5391 | KL(v||s)=0.719187 | cos_sim=0.007
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.6357 | f1=0.7225 | conf=0.641 | pos_rate=0.807
  → Agreement=0.6703 | KL(v||s)=0.335090 | cos_sim=0.034

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5524 | f1=0.6897 | conf=0.718 | pos_rate=0.937
  → Agreement=0.5916 | KL(v||s)=0.566445 | cos_sim=0.004
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 43

================================================
SEED 43 | BUDGET 1000 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=1000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget1000_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=1000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget1000_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=1000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed43_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=1000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 1000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.5065 | f1=0.6719 | conf=0.644 | pos_rate=0.999
  → Agreement=0.5356 | KL(v||s)=0.427430 | cos_sim=0.022

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5054 | f1=0.6714 | conf=0.715 | pos_rate=1.000
  → Agreement=0.5394 | KL(v||s)=0.673042 | cos_sim=-0.009
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.7900 | f1=0.8173 | conf=0.810 | pos_rate=0.644
  → Agreement=0.8353 | KL(v||s)=0.175591 | cos_sim=0.016

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5054 | f1=0.6714 | conf=0.664 | pos_rate=1.000
  → Agreement=0.5394 | KL(v||s)=0.659283 | cos_sim=-0.015
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 43

================================================
SEED 43 | BUDGET 5000 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=5000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed43_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=5000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed43_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=5000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed43_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=5000, seed=43...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed43.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed43_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 43 | BUDGET 5000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.5383 | f1=0.6845 | conf=0.695 | pos_rate=0.958
  → Agreement=0.5667 | KL(v||s)=0.402618 | cos_sim=0.018

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.6110 | f1=0.7186 | conf=0.791 | pos_rate=0.877
  → Agreement=0.6520 | KL(v||s)=0.559355 | cos_sim=-0.006
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=43 | budget=5000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8969 | f1=0.9010 | conf=0.895 | pos_rate=0.535
Stolen:  acc=0.6465 | f1=0.7160 | conf=0.746 | pos_rate=0.739
  → Agreement=0.6731 | KL(v||s)=0.390147 | cos_sim=-0.000

--- WITH DP ---
Victim:  acc=0.8686 | f1=0.8742 | conf=0.977 | pos_rate=0.539
Stolen:  acc=0.5308 | f1=0.6809 | conf=0.827 | pos_rate=0.965
  → Agreement=0.5645 | KL(v||s)=0.810452 | cos_sim=-0.012
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 5000, seed 43

================================================
Completed all budgets for SEED 43
================================================

================================================
SEED 44 - Training Victim Models
================================================
[qnli] Training victim (no DP) with seed 44...
[Task] qnli (GLUE/qnli) | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[Save] checkpoints/qnli/victim_qnli_P20_seed44.pt
[Log]  checkpoints/qnli/victim_qnli_P20_seed44.json
Epoch 0 | val acc=0.4946 | conf=0.982 | ||P||=1.02 | pos_rate=0.000
Epoch 1 | train_loss=0.3139 | val acc=0.8924 | conf=0.884 | ||P||=12.95 | pos_rate=0.505
  ✓ Saved best prompt (acc=0.8924) to checkpoints/qnli/victim_qnli_P20_seed44.pt
Epoch 2 | train_loss=0.2633 | val acc=0.8927 | conf=0.893 | ||P||=16.20 | pos_rate=0.481
  ✓ Saved best prompt (acc=0.8927) to checkpoints/qnli/victim_qnli_P20_seed44.pt
Epoch 3 | train_loss=0.2544 | val acc=0.8940 | conf=0.896 | ||P||=19.58 | pos_rate=0.483
  ✓ Saved best prompt (acc=0.8940) to checkpoints/qnli/victim_qnli_P20_seed44.pt
Done. Best val acc=0.8940 | saved=checkpoints/qnli/victim_qnli_P20_seed44.pt
✓ Victim (no DP) saved to checkpoints/qnli/victim_qnli_P20_seed44.pt
[qnli] Training victim (DP) with seed 44...
[Task] qnli (GLUE/qnli) | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Model] t5-small | prompt_len=20 | prompt_params=10,240
[DP] eps=8.0 C=0.1
[Save] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt
[Log]  checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.json
[DP] batch_size=256 steps=1227 sample_rate=0.002444 sigma=0.4727
Epoch 0 | val acc=0.4946 | conf=0.982 | ||P||=1.02 | pos_rate=0.000
Epoch 1 | val acc=0.8512 | conf=0.971 | ||P||=19.27 | pos_rate=0.509
  ✓ Saved best DP prompt (acc=0.8512) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt
Epoch 2 | val acc=0.8596 | conf=0.973 | ||P||=26.76 | pos_rate=0.482
  ✓ Saved best DP prompt (acc=0.8596) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt
Epoch 3 | val acc=0.8638 | conf=0.972 | ||P||=32.34 | pos_rate=0.486
  ✓ Saved best DP prompt (acc=0.8638) to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt
Done. Best val acc=0.8638 | saved=checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt
✓ Victim (DP) saved to checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt

================================================
SEED 44 | BUDGET 200 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=200, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget200_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=200, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget200_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=200, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget200_seed44_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=200, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=200 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=200
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget200_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 200 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=200 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.4946 | f1=0.0000 | conf=0.660 | pos_rate=0.000
  → Agreement=0.5167 | KL(v||s)=0.464448 | cos_sim=-0.009

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.5684 | f1=0.4648 | conf=0.556 | pos_rate=0.301
  → Agreement=0.5859 | KL(v||s)=0.601212 | cos_sim=0.000
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=200 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.4946 | f1=0.0000 | conf=0.789 | pos_rate=0.000
  → Agreement=0.5167 | KL(v||s)=0.597117 | cos_sim=-0.019

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.6138 | f1=0.6667 | conf=0.566 | pos_rate=0.653
  → Agreement=0.6222 | KL(v||s)=0.589857 | cos_sim=-0.010
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 200, seed 44

================================================
SEED 44 | BUDGET 500 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=500, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget500_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=500, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget500_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=500, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget500_seed44_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=500, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=500 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=500
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget500_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 500 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=500 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.4950 | f1=0.0058 | conf=0.647 | pos_rate=0.003
  → Agreement=0.5175 | KL(v||s)=0.430885 | cos_sim=0.000

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.5147 | f1=0.6059 | conf=0.562 | pos_rate=0.726
  → Agreement=0.5038 | KL(v||s)=0.635204 | cos_sim=0.000
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=500 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.4950 | f1=0.0036 | conf=0.698 | pos_rate=0.001
  → Agreement=0.5171 | KL(v||s)=0.467699 | cos_sim=0.002

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.5268 | f1=0.6685 | conf=0.554 | pos_rate=0.922
  → Agreement=0.5173 | KL(v||s)=0.622350 | cos_sim=-0.001
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 500, seed 44

================================================
SEED 44 | BUDGET 1000 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=1000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget1000_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=1000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget1000_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=1000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed44_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=1000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=1000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=1000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget1000_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 1000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=1000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.5056 | f1=0.0728 | conf=0.584 | pos_rate=0.028
  → Agreement=0.5296 | KL(v||s)=0.408718 | cos_sim=-0.016

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.5297 | f1=0.6163 | conf=0.556 | pos_rate=0.720
  → Agreement=0.5206 | KL(v||s)=0.628857 | cos_sim=-0.019
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=1000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.4946 | f1=0.0000 | conf=0.745 | pos_rate=0.000
  → Agreement=0.5167 | KL(v||s)=0.535076 | cos_sim=-0.032

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.5127 | f1=0.6705 | conf=0.532 | pos_rate=0.974
  → Agreement=0.4941 | KL(v||s)=0.627783 | cos_sim=-0.021
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 1000, seed 44

================================================
SEED 44 | BUDGET 5000 - Stealing
================================================
[qnli] Stealing (soft, no DP) | budget=5000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed44_soft.pt
✓ Stolen (soft, no DP) saved
[qnli] Stealing (hard, no DP) | budget=5000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_qnli_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_nodp_budget5000_seed44_hard.pt
✓ Stolen (hard, no DP) saved
[qnli] Stealing (soft, DP) | budget=5000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed44_soft.pt
✓ Stolen (soft, DP) saved
[qnli] Stealing (hard, DP) | budget=5000, seed=44...
[Task] qnli | labels=['entailment', 'not_entailment'] | verbalizers=['entailment', 'not entailment']
[Victim] checkpoints/qnli/victim_dp_qnli_eps8.0_P20_seed44.pt | prompt_len=20
[Steal] steal_ds=auto budget=5000 epochs=20 bs=256 lr=0.01
[Info] auto-selecting qqp as steal_ds
[Steal] ds_len=5000
Saved stolen prompt to checkpoints/qnli/stolen_qnli_dp_eps8.0_budget5000_seed44_hard.pt
✓ Stolen (hard, DP) saved

================================================
SEED 44 | BUDGET 5000 - Evaluation
================================================
[qnli] Evaluating soft oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=5000 | oracle=probs
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.5814 | f1=0.4143 | conf=0.624 | pos_rate=0.209
  → Agreement=0.5988 | KL(v||s)=0.396772 | cos_sim=-0.014

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.6626 | f1=0.7258 | conf=0.733 | pos_rate=0.725
  → Agreement=0.6798 | KL(v||s)=0.538849 | cos_sim=0.015
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_probs.csv
  - results/qnli/qnli/results_dp_probs.csv

[qnli] Evaluating hard oracle results...

================================================================================
EVALUATING: QNLI | seed=44 | budget=5000 | oracle=hard
================================================================================

Evaluating victim (no DP)...
Evaluating stolen (no DP)...
Evaluating victim (DP)...
Evaluating stolen (DP)...
Evaluating pair (no DP)...
Evaluating pair (DP)...

================================================================================
RESULTS: QNLI
================================================================================

--- NO DP ---
Victim:  acc=0.8940 | f1=0.8928 | conf=0.896 | pos_rate=0.483
Stolen:  acc=0.6143 | f1=0.5004 | conf=0.657 | pos_rate=0.267
  → Agreement=0.6295 | KL(v||s)=0.383967 | cos_sim=-0.003

--- WITH DP ---
Victim:  acc=0.8638 | f1=0.8626 | conf=0.972 | pos_rate=0.486
Stolen:  acc=0.6302 | f1=0.7169 | conf=0.747 | pos_rate=0.801
  → Agreement=0.6390 | KL(v||s)=0.579857 | cos_sim=0.001
================================================================================

✓ Results saved to results/qnli/qnli/
  - results/qnli/qnli/results_nodp_hard.csv
  - results/qnli/qnli/results_dp_hard.csv

✓ Evaluations complete for budget 5000, seed 44

================================================
Completed all budgets for SEED 44
================================================


==========================================
TASK qnli COMPLETE!
Results saved to: results/qnli
==========================================
